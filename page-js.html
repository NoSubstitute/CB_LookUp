<script>
    document.getElementById('idCBS').readOnly = true;

    document.getElementById("btnserno").addEventListener("click",fetchCBS);
    function fetchCBS(){
        document.getElementById("idCBS").innerHTML = "";
        var sernum = document.getElementById("serial").value;
        google.script.run
        .withSuccessHandler(printCBS)
        .queryCBS(sernum);
        document.getElementById("serial").value = "";
    }
    
    window.printCBS = function(CBS) {
    console.log(CBS);
    
    var i,innerArray;
    var L = CBS[0].length;
  
    for (i=0;i<L;i++) {
    innerArray = CBS[0][i];
  
    value1 = innerArray[0]; 
    value2 = innerArray[1];
    value3 = innerArray[2];
    value4 = innerArray[3];
    value5 = innerArray[4];

  
    console.log(value1 + "__" + value2 + "__" + value3 + "__" + value4 + "__" + value5)
//    console.log(value1 + "__" + value2 + "__" + value3 + "__" + value4)
    
    let html='<style>td,th{border:0px solid black;}</style><table>';
        html+='<tr><td>' + value1 + '</td><td>' + value2 + '</td><td>' + value3 + '</td><td>' + value4 + '</td><td>' + value5 + '</td></tr>';
//        html+='<tr><td>' + value1 + '</td><td>' + value2 + '</td><td>' + value3 + '</td><td>' + value4 + '</td></tr>';
    html+='</table>';

// This works just as well as the variant with var myTable below.
//    document.getElementById("idCBS").innerHTML += html;
    
    var myTable = document.getElementById("idCBS");
    myTable.insertAdjacentHTML("beforeend", html);
    }
}
    
    document.getElementById("btnusername").addEventListener("click",fetchUserDevices);
    function fetchUserDevices(){
        document.getElementById("idCBS").innerHTML = "";
        var uname = document.getElementById("username").value;
        google.script.run
        .withSuccessHandler(printUD)
        .queryUserDevices(uname);
        document.getElementById("username").value = "";
    }

        window.printUD = function(UD) {
        console.log(UD);

    var i,innerArray;
    var L = UD[0].length;
  
    for (i=0;i<L;i++) {
    innerArray = UD[0][i];
  
    value1 = innerArray[0]; 
    value2 = innerArray[1];
    value3 = innerArray[2];
    value4 = innerArray[3];
    value5 = innerArray[4];
  
    console.log(value1 + "__" + value2 + "__" + value3 + "__" + value4 + "__" + value5)
//    console.log(value1 + "__" + value2 + "__" + value3 + "__" + value4)
    
    let html='<style>td,th{border:0px solid black;}</style><table>';
        html+='<tr><td>' + value1 + '</td><td>' + value2 + '</td><td>' + value3 + '</td><td>' + value4 + '</td><td>' + value5 + '</td></tr>';
//        html+='<tr><td>' + value1 + '</td><td>' + value2 + '</td><td>' + value3 + '</td><td>' + value4 + '</td></tr>';
    html+='</table>';

// This works just as well as the variant with var myTable below.
//    document.getElementById("idCBS").innerHTML += html;
    
    var myTable = document.getElementById("idCBS");
    myTable.insertAdjacentHTML("beforeend", html);
    }
}

    document.getElementById("clearResults").addEventListener("click",clrResults);
    function clrResults(){
        document.getElementById("idCBS").innerHTML = "";
    }

</script>
